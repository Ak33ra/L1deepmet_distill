<property object at 0x151edf4169f0>
/hildafs/projects/phy230010p/share/NanoAOD/data4L1/data_ttbar/raw
/hildafs/projects/phy230010p/share/NanoAOD/data4L1/data_ttbar/processed
length of train/val data:  746250 248750
2
746250
248750
<class 'torch_geometric.deprecation.DataLoader'>
cuda
model initialized
Current best loss: 100000000.0
Learning rate: 0.0001
  0%|          | 0/11661 [00:00<?, ?it/s]  0%|          | 0/11661 [00:00<?, ?it/s]
data: DataBatch(x=[3130, 8], edge_index=[2, 0], y=[64, 2], batch=[3130], ptr=[65])
x_cont: tensor([[  34.5000,  -16.6250,   30.2301,  ...,    1.0000,  211.0000,
            1.0000],
        [  32.0000,   -5.2815,  -31.5611,  ...,    1.0000,   22.0000,
            0.0000],
        [  31.7500,  -20.5606,   24.1934,  ...,    1.0000,   11.0000,
           -1.0000],
        ...,
        [   2.2500,    1.4419,    1.7273,  ...,    1.0000, -211.0000,
           -1.0000],
        [   4.0000,   -2.7007,    2.9506,  ...,    1.0000,  211.0000,
            1.0000],
        [   2.2500,   -1.6880,    1.4877,  ...,    1.0000, -211.0000,
           -1.0000]], device='cuda:0')
x_cat: tensor([], device='cuda:0', size=(3130, 0), dtype=torch.int64)
edge_index: tensor([[   0,    0,    0,  ..., 3129, 3129, 3129],
        [   1,    3,   13,  ..., 3103, 3122, 3128]], device='cuda:0')
Traceback (most recent call last):
  File "/hildafs/projects/phy230010p/share/NanoAOD/teacher_deepmet/train.py", line 134, in <module>
    train_loss = train(model, device, optimizer, scheduler, loss_fn, train_dl, epoch)
  File "/hildafs/projects/phy230010p/share/NanoAOD/teacher_deepmet/train.py", line 54, in train
    result = model(x_cont, x_cat, edge_index, data.batch)
  File "/hildafs/projects/phy230010p/share/test_env_2025_gpu/env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/hildafs/projects/phy230010p/share/NanoAOD/teacher_deepmet/model/net.py", line 46, in forward
    weights = self.graphnet(x_cont, x_cat, edge_index, batch)
  File "/hildafs/projects/phy230010p/share/test_env_2025_gpu/env/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/hildafs/projects/phy230010p/share/NanoAOD/teacher_deepmet/model/graph_met_network.py", line 62, in forward
    emb_chrg = self.embed_charge(x_cat[:, 1] + 1)
IndexError: index 1 is out of bounds for dimension 1 with size 0
